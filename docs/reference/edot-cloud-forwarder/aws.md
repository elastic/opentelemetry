---
navigation_title: AWS
description: Set up the EDOT Cloud Forwarder for AWS to bring your AWS logs to Elastic Observability.
applies_to:
  serverless:
    observability: preview
products:
  - id: cloud-serverless
  - id: observability
  #- id: edot-cf
---

# EDOT Cloud Forwarder for AWS

{{edot-cf}} for AWS provides the EDOT Collector as a Lambda function that collects and forwards logs to Elastic Observability on {{serverless-full}}. {{edot-cf}} for AWS supports the following log sources:

| Log source | Description |
| --- | --- |
| VPC Flow | Logs generated by a VPC (Virtual Private Cloud). |
| ELB Access | Logs generated by an ELB (Elastic Load Balancer). |
| CloudWatch | Logs generated by AWS CloudWatch. |

Read on to learn how to set up {{edot-cf}} for AWS.

## Prerequisites

To collect logs using {{edot-cf}} for AWS you need:

::::{tab-set}

:::{tab-item} VPC Flow

To collect VPC Flow logs, you need:

- A VPC (Virtual Private Cloud).
- An S3 bucket for storing flow logs.
- A flow log configured with the S3 bucket as the destination.

:::

:::{tab-item} ELB Access

To collect ELB (Elastic Load Balancer) Access logs, you need:

- An ELB of any type (ALB, NLB, CLB).
- An S3 bucket to store the access logs.
- Access logging enabled, with the bucket as the destination.

:::
::::

In addition, you need to know the URL of the managed OTLP endpoint and the API key for authentication.

:::{include} ../_snippets/serverless-endpoint-api.md
:::

## Deployment considerations

Before deploying {{edot-cf}} for AWS, keep these points in mind:

- Deploy a separate stack for each log type, for example VPC Flow Logs, ELB Logs, or CloudWatch Logs. Each CloudFormation stack can only process one log source and format at a time.
- Logs stored in S3 must be placed in separate buckets. Each log type should reside in its own dedicated bucket. 

## Configure the CloudFormation template

{{edot-cf}} for AWS uses a CloudFormation template to deploy the EDOT Collector as a Lambda function.

::::::{stepper}

:::::{step} Download the CloudFormation template

Download the `cloudformation.yaml` file from the [{{edot-cf}} for AWS GitHub repository](https://github.com/elastic/edot-cloud-forwarder-aws/blob/main/cloudformation.yaml).

:::::

:::::{step} Edit the settings in the template

These are the required parameters you need to set in the CloudFormation template:

| Parameter | Description |
| --- | --- |
| `region` | AWS region where the CloudFormation stack is to be deployed. |
| `stack-name` | Name of the CloudFormation stack. For example, `vpc-edot-cf`. Do not use the same name for different sources. |
| `EdotCloudForwarderSource` | Source of logs to be processed. Available options are `s3_logs` and `cloudwatch_logs`. |
| `EdotCloudForwarderVersion` | Version of the EDOT Cloud Forwarder. Expected format is `0-1-2`, with hyphens replacing dots. Check available versions in the [GitHub repository](https://github.com/elastic/edot-cloud-forwarder-aws/releases). |
| `ElasticOtlpEndpoint` | The Elastic OTLP endpoint URL used for data ingestion. |
| `ElasticApiKey` | API key for authentication with Elastic. |

Additionally, you need to set the following parameters based on the log source:

::::{tab-set}

:::{tab-item} S3

If `EdotCloudForwarderSource` is `s3_logs`, set these options:

| Parameter | Description |
| --- | --- |
| `EdotCloudForwarderS3Bucket` | The S3 bucket where logs are stored. This bucket will trigger the `edot-cloud-forwarder` Lambda function automatically. |
| `EdotCloudForwardeS3LogsEncoding` | The encoding format for logs in the S3 bucket. Supported options:<br>• `vpc_flow_log` – VPC Flow Logs<br>• `elb_access_log` – Elastic Load Balancer (ELB) Access Logs<br>• `s3_access_log` – S3 Access Logs<br>• `json` – JSON-formatted logs |
| `EdotCloudForwardeS3LogsJsonMode` | *(Required if `EdotCloudForwardeS3LogsEncoding` is `json`)*<br>Defines how JSON logs are structured:<br>• `body` *(default)* – Stores logs in the request body<br>• `body_with_inline_attributes` – Logs include inline attributes |

:::

:::{tab-item} CloudWatch

If `EdotCloudForwarderSource` is `cloudwatch_logs`, set the following options:

| Parameter | Description |
| --- | --- |
| `EdotCloudForwarderCloudWatchLogGroup` | Name of the CloudWatch Log Group where the subscription filter will be created. |

:::
::::
:::::
::::::

### Optional settings

These are optional parameters you can set in the CloudFormation template:

| Parameter | Description |
| --- | --- |
| `EdotCloudForwarderLambdaName` | Set a custom name for the Lambda function. Default value is `edot-cloud-forwarder`. |
| `EdotCloudForwarderTimeout` | Maximum execution time for the Lambda function, measured in seconds. Default value is `300` seconds. Maximum value is `900` seconds. Minimum value is `1` second. |
| `EdotCloudForwarderMemorySize` | Set the allocated memory for the Lambda function, measured in megabytes. Default value is `1024` MB. Maximum value is `10240` MB. Minimum value is `128` MB. | 

## Deployment examples

The following examples use the `cloudformation.yaml` file included in the {{edot-cf}} for AWS repository.

### VPC Flow logs collection

This example deploys a CloudFormation stack to collect VPC Flow Logs stored in an S3 bucket.

```sh
aws cloudformation deploy \
  --template-file cloudformation.yaml \
  --stack-name edot-cloud-forwarder-vpc \
  --capabilities CAPABILITY_NAMED_IAM \
  --region eu-central-1 \
  --parameter-overrides \
    EdotCloudForwarderLambdaName=your-ecf-vpc \
    EdotCloudForwarderS3Bucket=your-s3-vpc-bucket \
    ElasticOtlpEndpoint="<placeholder>" \
    ElasticApiKey="<placeholder>" \
    EdotCloudForwarderVersion=0-1-2 \
    EdotCloudForwarderSource=s3_logs \
    EdotCloudForwardeS3LogsEncoding="vpc_flow_log"
```

### ALB Access logs collection

This example deploys a CloudFormation stack to collect ALB Access Logs stored in an S3 bucket.

```sh
aws cloudformation deploy \
  --template-file cloudformation.yaml \
  --stack-name edot-cloud-forwarder-alb \
  --capabilities CAPABILITY_NAMED_IAM \
  --region eu-central-1 \
  --parameter-overrides \
    EdotCloudForwarderLambdaName=your-ecf-alb \
    EdotCloudForwarderS3Bucket=your-s3-alb-bucket \
    ElasticOtlpEndpoint="<placeholder>" \
    ElasticApiKey="<placeholder>" \
    EdotCloudForwarderVersion=0-1-2 \
    EdotCloudForwarderSource=s3_logs \
    EdotCloudForwardeS3LogsEncoding="elb_access_log"
```

### CloudWatch logs collection

This example deploys a CloudFormation stack to collect CloudWatch logs sent to a Log Group.

```sh
aws cloudformation deploy \
  --template-file cloudformation.yaml \
  --stack-name edot-cloud-forwarder-cw \
  --capabilities CAPABILITY_NAMED_IAM \
  --region eu-central-1 \
  --parameter-overrides \
    EdotCloudForwarderLambdaName=your-ecf-cw \
    ElasticOtlpEndpoint="<placeholder>" \
    ElasticApiKey="<placeholder>" \
    EdotCloudForwarderVersion=0-1-2 \
    EdotCloudForwarderSource=cloudwatch_logs \
    EdotCloudForwarderCloudWatchLogGroup="your-log-group"
```
