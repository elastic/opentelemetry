---
navigation_title: AWS
description: Set up the EDOT Cloud Forwarder for AWS to bring your AWS logs to Elastic Observability.
applies_to:
  serverless:
    observability:
  deployment:
    ess:
    self: unavailable
  product:
    edot_cf_aws: ga 1.0.0, preview =0.2.6
products:
  - id: cloud-serverless
  - id: observability
  - id: edot-cf
---

# EDOT Cloud Forwarder for AWS

{{edot-cf}} (CF) for AWS provides the EDOT Collector as a Lambda function that collects and forwards logs to {{motlp}}. 

{{edot-cf}} for AWS supports the following log sources:

| AWS service | Telemetry description | Availability |
| --- | --- | --- |
| Virtual Private Cloud (VPC) | [VPC Flow Logs](https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html) to capture information about IP traffic.  | {applies_to}`edot_cf_aws: ga 1.0.0, preview =0.2.6` |
| Elastic Load Balancer (ELB) | [Access logs](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-access-logs.html) for your Application Load Balancer. | {applies_to}`edot_cf_aws: ga 1.0.0, preview =0.2.6` |
| AWS CloudTrail | [CloudTrail Logs](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-examples.html) to record account activity. | {applies_to}`edot_cf_aws: preview 0.2.6` |
% | CloudWatch {applies_to}`product: planned` | Logs generated by AWS CloudWatch. | Technical Preview |

## Prerequisites

To collect logs using {{edot-cf}} for AWS, you need the following:

::::{tab-set}

:::{tab-item} VPC Flow

To collect VPC Flow logs, you need:

- A Virtual Private Cloud (VPC)
- An S3 bucket for storing flow logs
- A flow log configured with the S3 bucket as the destination
- An Elastic Managed OTLP endpoint and an API key. Refer to [Endpoint and API key](#endpoint-and-api-key).

:::

:::{tab-item} ELB Access

To collect Elastic Load Balancer (ELB) Access logs, you need:

- An ELB of any type (ALB, NLB, CLB)
- An S3 bucket to store the access logs
- Access logging enabled, with the bucket as the destination
- An Elastic Managed OTLP endpoint and an API key. Refer to [Endpoint and API key](#endpoint-and-api-key).

:::

:::{tab-item} CloudTrail

To collect AWS CloudTrail logs, you need:

- A trail that delivers account events as log files to an Amazon S3 bucket
- An S3 bucket to store the trail logs
- An Elastic Managed OTLP endpoint and an API key. Refer to [Endpoint and API key](#endpoint-and-api-key).

:::

<!--
:::{tab-item} CloudWatch

To collect CloudWatch logs, you need:

- A CloudWatch Log Group where logs are stored

:::
-->
::::

### Endpoint and API key

:::{include} ../../_snippets/find-motlp-endpoint.md
:::

:::{important}
Trim the API key from `Authorization=ApiKey MYKEYVALUE...` to just `MYKEYVALUE...` before using it as the argument to the `ElasticAPIKey` parameter.
:::

## Quick start

Deploy {{edot-cf}} for AWS with one click using the AWS CloudFormation console:

[![Launch Stack](https://s3.amazonaws.com/cloudformation-examples/cloudformation-launch-stack.png)](https://console.aws.amazon.com/cloudformation/home?#/stacks/new?templateURL=https://edot-cloud-forwarder.s3.amazonaws.com/v1/latest/cloudformation/s3_logs-cloudformation.yaml)

After clicking the button:

1. Configure the required parameters:

   | Parameter | Description |
   | --- | --- |
   | `stack-name` | Name of the CloudFormation stack, for example `vpc-edot-cf`. |
   | `OTLPEndpoint` | The OTLP endpoint URL from {{serverless-full}} or {{ech}}. |
   | `ElasticApiKey` | API key for authentication with Elastic. |
   | `SourceS3BucketARN` | ARN of the S3 bucket where your logs are stored. |
   | `EdotCloudForwarderS3LogsType` | The log type: `vpcflow`, `elbaccess`, or `cloudtrail`. |

2. Select **Next** and check **Acknowledge IAM capabilities**.
3. Review your configuration and select **Submit** to deploy the stack.
4. Monitor the progress until the stack reaches the `CREATE_COMPLETE` state.

:::{tip}
The CloudFormation stack deployment region must match the region of the S3 bucket where your logs are stored.
:::

## Deployment considerations

Before deploying {{edot-cf}} for AWS, consider the following:

- Deploy a separate CloudFormation stack for each log type, for example VPC Flow Logs or ELB Access Logs. Each CloudFormation stack can only process one log type and format at a time.
- Logs stored in S3 must be placed in separate buckets. Each log type should reside in its own dedicated bucket.
- The CloudFormation stack deployment region must match the region of the S3 bucket.

## Datastreams

Logs collected by {{edot-cf}} for AWS are stored in {{es}} datastreams in OpenTelemetry native format. The following table shows which datastreams are used for each log type:

| **AWS log type** | **Datastream dataset** | **Description**                        |
|------------------|------------------------|----------------------------------------|
| VPC Flow Logs    | `aws.vpcflow.otel`     | VPC Flow Log records                   |
| ELB Access Logs  | `aws.elbaccess.otel`   | ELB Access Log records (ALB, NLB, CLB) |

The logs are produced in OpenTelemetry native format. For detailed information about the field mappings and structure of each log type, refer to the following documentation:

- **VPC Flow Logs**: See [VPC Flow Log record fields](https://github.com/occamshub-dev/opentelemetry-collector-contrib/blob/main/extension/encoding/awslogsencodingextension/README.md#vpc-flow-log-record-fields) for the complete field mapping.
- **ELB Access Logs**: See [ELB Access Log fields](https://github.com/occamshub-dev/opentelemetry-collector-contrib/blob/main/extension/encoding/awslogsencodingextension/README.md#elb-access-log-fields) for the complete field mapping.

## Kibana integration setup

After {{edot-cf}} for AWS is successfully running and forwarding logs to {{product.observability}}, install the {{kib}} integrations to visualize your data with out-of-the-box dashboards and visualizations.

To set up data visualization in {{kib}}:

1. Log into your {{ecloud}} deployment and open {{kib}}
2. Go to **Management** â†’ **Integrations** in the {{kib}} navigation menu.
3. Search for the appropriate integration based on your log type and install it:

   | **AWS log type** | **Integration name**                         | **Description**                                              |
   |------------------|----------------------------------------------|--------------------------------------------------------------|
   | ELB Access Logs  | **AWS ELB OpenTelemetry Assets**             | Dashboards and visualizations for Elastic Load Balancer logs |
   | VPC Flow Logs    | **AWS VPC Flow Logs OpenTelemetry Assets**   | Dashboards and visualizations for VPC flow log data          |
   | CloudTrail Logs  | **AWS CloudTrail Logs OpenTelemetry Assets** | Dashboards and visualizations for CloudTrail log data        |

4. Once installed, navigate to **Dashboard** to view the pre-built dashboards for your AWS log data.

## Limitations

{{edot-cf}} for AWS has the following limitations:

| Limitation | Description |
| --- | --- |
| **VPC/PrivateLink not supported** | {{edot-cf}} cannot be deployed inside a VPC or use AWS PrivateLink endpoints. The Lambda function requires public internet access to forward data to the OTLP endpoint. |
| **Managed OTLP Input only** | {{edot-cf}} is tested exclusively with {{motlp}}. Forwarding to a self-deployed EDOT Collector Gateway is not tested and forwarding to APM Server is not supported. |
| **Single log type per bucket** | Each S3 bucket can only contain one log type. Mixed log formats in the same bucket are not supported yet. |

## Next steps

- [Configure the template](configure.md): Learn about all configuration options, including optional settings and sizing recommendations.
- [Deployment methods](deploy.md): Explore alternative deployment methods using AWS CLI or AWS Serverless Application Repository.
- [Troubleshooting](troubleshooting.md): Diagnose and resolve issues with log forwarding.
